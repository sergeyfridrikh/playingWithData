# data_analysis

*data_analysis* is a Python module for processing data on urine sample tests.

The module contains functions that read in experimental data from a .csv file 
into a data frame. The data frame is split into three separate data frames 
containing data related to: 
* sample antibiotic resistance,
* antibiotic resistance gene detection,
* organism cell counts.

For sample antibiotic resistance we looked at resistance to each of the antibiotics 
independently. 

Statistics for antibiotic resistance (AR) gene detection is presented in a bat chart.
To check for potential correlation between AR genes we also calculated and plotted 
correlation matrix (Pearson correlation coefficient). For the test data set we found 
no significant correlation between the AR genes.

Lots of organism cell counts came out as zeroes. Hence, we plot all cell count 
histograms with peak around zero truncated. An additional plot generated by 
*plot_stats_for_zero_cell_counts* provides information about samples with 
zero organism cell counts.

Unite testing file and data sets for the *load_additional_data* function 
are stored in test sub-folder.

# Results of data analysis for the test data set.

* Antibiotic resistance of teh samples decreases monotonously for antibiotics 
1 to 17 from 90 to 22%.
* Antibiotic resistance genes 1 to 5 were detected in 4% (Gene_5) to 31% (Gene_1)
of the samples.
* We found no significant correlation between these five AR genes.
* Organism cells were detected in 4-38% of the sample depending on the organism.


## List of Functions

### *plot_ab_resistance(data)*
    Creates a plot of percentages of samples resistant/susceptible to antibiotics.

        Calculates percentages of samples from the data frame R/S to antibiotics .
        Uses matplotlib barh function to plot the results.

        Args:
            A dataframe with data on AB resistance.
            Each row is a sample, each column is an antibiotic.

        Returns:
            A matplotlib horizontal bar chart for AB resistance percentages.

>Usage
> ```python
> 
>> data_analysis.plot_ab_resistance(data)
>>
>> # returns matplotlib plot of AB resistance percentages
>> ```

### *plot_gene_counts(data)*
    Creates a plot of numbers of samples containing AR genes.

        Calculates numbers of samples containing AR genes.
        Uses matplotlib bar function to plot the results.

        Args:
            A dataframe with data on AR genes detected in the samples.
            Each row is a sample, each column is an AR gene.

        Returns:
            A matplotlib bar chart for numbers of samples containing AR genes.

>Usage
> ```python
> 
>> data_analysis.plot_gene_counts(data)
>>
>> # returns matplotlib plot of numbers of samples containing AR genes
>> ```

### *plot_gene_correlations(data)*
    Creates a plot for correlation matrix of AB resistance genes.

        Calculates correlation matrix for AB resistance genes detected in teh samples.
        Uses sns.heatmap to visualize the correlation matrix,

        Args:
            A dataframe with data on AB resistance genes detected in the samples.
            Each row is a sample, each column is an AR gene.

        Returns:
            A seaborn heatmap for correlation matrix for AB resistance genes.

>Usage
> ```python
> 
>> data_analysis.plot_gene_correlations(data)
>>
>> # returns seaborn heatmap of correlation matrix for AB resistance genes
>> ```

### *plot_multiple_cell_count_histograms(df, bins=20)*
    Creates a set of cell count histograms.

        Creates histograms for each organism cell counts in all samples.
        Generates a matplotlib plot covering all these histograms.

        Args:
            A dataframe with data on cell counts.
            Each row is a sample, each column is an organism.

        Returns:
            A matplotlib histogram plot for organism cell counts in all samples

>Usage
> ```python
> 
>> data_analysis.plot_multiple_cell_count_histograms(data)
>>
>> # returns matplotlib histogram plot for organism cell counts in all samples
>> ```

### *plot_stats_for_zero_cell_counts(data_df_cellcount)*
    Creates a plot of counts of the samples without any cells detected.

        Calculates counts of the samples without any cells detected for each organism type.
        Creates a matplotlib plot for these counts.

        Args:
            A dataframe with data on sample cell counts.
            Each row is a sample, each column is an organism.

        Returns:
            A matplotlib bar chart for counts of the samples without any cells detected.

>Usage
> ```python
> 
>> data_analysis.plot_stats_for_zero_cell_counts(data)
>>
>> # returns matplotlib bar chart for counts of the samples without any cells detected
>> ```

### *load_data(data_file_name)*
    Reads a CSV data file from work directory.

    Args:
        A name of the .csv data file located in home directory

    Returns:
        A data frame containing information from the .csv data file.

>Usage
> ```python
> 
>> data_analysis.load_data(data_file_name)
>>
>> # returns data table containing the data from the input .csv file
>> ``` 

### *load_additional_data(main_data, add_data_file)*
    Reads a CSV file with additional data and appends it to already existing data.

        Reads a CSV file with additional data from working directory.
        Appends additional data to already existing dataframe.
        Returns the resulting dataframe.

        Args:
            A dataframe with data already in use.
            File name for the files with additional data.

        Returns:
            A data frame generated by concatenation or existing and additional data.

>Usage
> ```python
> 
>> data_analysis.load_data(main_data, add_data_file)
>>
>> # returns data table comprising original and additional data
> ```

    
### *main()*
    Reads a CSV file with urine sample tests, runs data analysis and generates plots for the analysis results.

            Reads a CSV file with urine sample tests.
            Runs several functions to perform data analysis and to generate teh relevant plots:
            plot_ab_resistance - for samples' antibiotic resistance
            plot_gene_counts & plot_gene_correlations - for gene detection
            plot_multiple_cell_count_histograms & plot_stats_for_zero_cell_counts - for cell counts.

            Args:

            Returns:
                A set of plots presenting the results of the data analysis.

## Contributing

Pull requests are welcome. For major changes, please open an issue first
to discuss what you would like to change.

Please make sure to update tests as appropriate.

## License

Sergey Fridrikh